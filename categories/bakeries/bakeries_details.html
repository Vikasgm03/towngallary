<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Shop Details | Vihara</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  :root { --primary: #5d4037; --bg-light: #efebe9; }
  body { font-family: 'Poppins', sans-serif; background: #fff; margin:0; padding:0; padding-bottom: 100px; }

  /* HEADER IMAGE */
  .detail-header { position: relative; height: 280px; }
  .detail-header img { width: 100%; height: 100%; object-fit: cover; }
  .back-btn { 
    position: absolute; top: 20px; left: 20px; 
    background: white; width: 40px; height: 40px; border-radius: 50%; 
    display: flex; align-items: center; justify-content: center; 
    color: #333; text-decoration: none; box-shadow: 0 5px 15px rgba(0,0,0,0.2); 
    z-index: 10;
  }

  /* CONTENT CARD */
  .detail-content { 
    padding: 25px; transform: translateY(-30px); 
    background: white; border-radius: 30px 30px 0 0; min-height: 500px; 
    position: relative;
  }
  
  h1 { margin: 0; color: #3e2723; font-size: 1.8rem; line-height: 1.2; }
  
  .meta-tags { margin-top: 15px; display: flex; flex-wrap: wrap; gap: 10px; }
  .tag { background: #f5f5f5; padding: 6px 12px; border-radius: 50px; font-size: 0.8rem; color: #555; display: flex; align-items: center; gap: 6px; }
  .tag i { color: var(--primary); }

  .description { color: #666; line-height: 1.6; margin-top: 20px; font-size: 0.95rem; }

  /* MENU SECTION */
  .menu-section { margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px; }
  .menu-section h2 { font-size: 1.2rem; margin-bottom: 15px; color: #3e2723; display: flex; align-items: center; gap: 10px; }
  .menu-img { width: 100%; border-radius: 12px; border: 1px solid #eee; box-shadow: 0 5px 20px rgba(0,0,0,0.05); }

  /* STICKY FOOTER BUTTON */
  .sticky-footer { 
    position: fixed; bottom: 0; left: 0; width: 100%; 
    background: white; padding: 15px 20px; 
    box-shadow: 0 -5px 20px rgba(0,0,0,0.1); 
    display: flex; gap: 10px; z-index: 100;
  }
  
  .btn-order { 
    flex: 1; background: #25D366; color: white; 
    text-decoration: none; padding: 15px; border-radius: 50px; 
    text-align: center; font-weight: bold; font-size: 1rem;
    display: flex; align-items: center; justify-content: center; gap: 10px; 
    box-shadow: 0 5px 15px rgba(37, 211, 102, 0.3);
    transition: transform 0.2s;
  }
  .btn-order:active { transform: scale(0.98); }
</style>
</head>
<body>

  <div class="detail-header">
    <a href="bakeries.html" class="back-btn"><i class="fas fa-arrow-left"></i></a>
    <img id="shopImg" src="" alt="Cover" onerror="this.src='../../images/default_bakery.jpg'">
  </div>

  <div class="detail-content">
    <h1 id="shopName">Loading Shop...</h1>
    
    <div class="meta-tags">
      <div class="tag"><i class="far fa-clock"></i> <span id="shopTime">...</span></div>
      <div class="tag"><i class="fas fa-star"></i> <span id="shopBest">...</span></div>
      <div class="tag"><i class="fas fa-map-marker-alt"></i> <span id="shopLoc">...</span></div>
    </div>
    
    <p id="shopDesc" class="description">...</p>

    <div class="menu-section">
      <h2><i class="fas fa-book-open"></i> Full Menu Card</h2>
      <img id="menuImg" class="menu-img" src="" alt="Menu Card" onerror="this.style.display='none'; document.getElementById('noMenuMsg').style.display='block';">
      <p id="noMenuMsg" style="display:none; color:#888; text-align:center; padding:20px; background:#f9f9f9; border-radius:10px;">
        Menu image not available yet. Please ask for options on WhatsApp.
      </p>
    </div>
  </div>

  <div class="sticky-footer">
    <a href="#" id="waLink" class="btn-order" target="_blank">
      <i class="fab fa-whatsapp"></i> Order on WhatsApp
    </a>
  </div>

  <script>
    async function loadDetails() {
      // 1. Get ID from URL
      const params = new URLSearchParams(window.location.search);
      const shopId = params.get('id');

      if (!shopId) {
        document.getElementById('shopName').innerText = "Shop not found";
        return;
      }

      try {
        // 2. Fetch Data
        const response = await fetch('bakeries_data.json');
        const shops = await response.json();

        // 3. Find the Shop
        const shop = shops.find(s => s.id === shopId);

        if (shop) {
          // Fill Data
          document.getElementById('shopName').innerText = shop.name;
          document.getElementById('shopImg').src = shop.image;
          document.getElementById('shopTime').innerText = shop.timings;
          document.getElementById('shopBest').innerText = shop.bestseller;
          document.getElementById('shopLoc').innerText = shop.location;
          document.getElementById('shopDesc').innerText = shop.description;
          
          // SET MENU IMAGE (Use shop image if menu missing)
          const menuSource = shop.menu_image ? shop.menu_image : "";
          document.getElementById('menuImg').src = menuSource;

          // SET WHATSAPP LINK (Vihara Founder Number)
          const founderNumber = "919483882133"; 
          const msg = `Hi Vihara, I am viewing the menu of *${shop.name}*. I would like to order:`;
          document.getElementById('waLink').href = `https://wa.me/${founderNumber}?text=${encodeURIComponent(msg)}`;
        } 
      } catch (error) {
        console.error("Error loading details:", error);
      }
    }

    loadDetails();
  </script>

</body>
</html>
